/*

Query para publicar a tabela.

Esse é o lugar para:
    - modificar nomes, ordem e tipos de colunas
    - dar join com outras tabelas
    - criar colunas extras (e.g. logs, proporções, etc.)

Qualquer coluna definida aqui deve também existir em `table_config.yaml`.

# Além disso, sinta-se à vontade para alterar alguns nomes obscuros
# para algo um pouco mais explícito.

TIPOS:
    - Para modificar tipos de colunas, basta substituir STRING por outro tipo válido.
    - Exemplo: `SAFE_CAST(column_name AS NUMERIC) column_name`
    - Mais detalhes: https://cloud.google.com/bigquery/docs/reference/standard-sql/data-types

*/

CREATE VIEW basedosdados-dev.br_ms_cnes.estabelecimento AS
SELECT 
SAFE_CAST(ano AS INT64) ano,
SAFE_CAST(mes AS INT64) mes,
SAFE_CAST(sigla_uf AS STRING) sigla_uf,
SAFE_CAST(id_municipio AS STRING) id_municipio,
SAFE_CAST(id_municipio_6 AS STRING) id_municipio_6,
SAFE_CAST(id_cnes AS STRING) id_cnes,
SAFE_CAST(regiao_saude AS STRING) regiao_saude,
SAFE_CAST(microrregiao_saude AS STRING) microrregiao_saude,
SAFE_CAST(distrito_sanitario AS STRING) distrito_sanitario,
SAFE_CAST(distrito_administrativo AS STRING) distrito_administrativo,
SAFE_CAST(cep AS STRING) cep,
SAFE_CAST(cpf_cnpj AS STRING) cpf_cnpj,
SAFE_CAST(indicador_pessoa AS STRING) indicador_pessoa,
SAFE_CAST(grau_dependencia AS STRING) grau_dependencia,
SAFE_CAST(cnpj_mantenedora AS STRING) cnpj_mantenedora,
SAFE_CAST(codigo_ir AS STRING) codigo_ir,
SAFE_CAST(vinculo_sus AS STRING) vinculo_sus,
SAFE_CAST(tipo_gestao AS STRING) tipo_gestao,
SAFE_CAST(esfera_administrativa AS STRING) esfera_administrativa,
SAFE_CAST(retencao_tributos AS STRING) retencao_tributos,
SAFE_CAST(atividade_ensino_pesquisa AS STRING) atividade_ensino_pesquisa,
SAFE_CAST(natureza_administrativa AS STRING) natureza_administrativa,
SAFE_CAST(fluxo_atendimento AS STRING) fluxo_atendimento,
SAFE_CAST(tipo_unidade AS STRING) tipo_unidade,
SAFE_CAST(turno AS STRING) turno,
SAFE_CAST(nivel_hierarquia AS STRING) nivel_hierarquia,
SAFE_CAST(tipo_prestador AS STRING) tipo_prestador,
SAFE_CAST(codigo_banco AS STRING) codigo_banco,
SAFE_CAST(codigo_agencia AS STRING) codigo_agencia,
SAFE_CAST(conta_corrente AS STRING) conta_corrente,
SAFE_CAST(contrato_municipio_sus AS STRING) contrato_municipio_sus,
SAFE_CAST(data_publicacao_contrato_municipal AS DATE) data_publicacao_contrato_municipal,
SAFE_CAST(contrato_estado_sus AS STRING) contrato_estado_sus,
SAFE_CAST(data_publicacao_contrato_estadual AS DATE) data_publicacao_contrato_estadual,
SAFE_CAST(numero_alvara AS STRING) numero_alvara,
SAFE_CAST(data_expedicao_alvara AS DATE) data_expedicao_alvara,
SAFE_CAST(orgao_expedidor AS STRING) orgao_expedidor,
SAFE_CAST(avaliacao_acreditacao_hospitalar AS STRING) avaliacao_acreditacao_hospitalar,
SAFE_CAST(classificacao_acreditacao_hospitalar AS STRING) classificacao_acreditacao_hospitalar,
SAFE_CAST(data_acreditacao_ano AS INT64) data_acreditacao_ano,
SAFE_CAST(data_acreditacao_mes AS INT64) data_acreditacao_mes,
SAFE_CAST(avaliacao_pnass AS STRING) avaliacao_pnass,
SAFE_CAST(data_avaliacao_pnass_ano AS INT64) data_avaliacao_pnass_ano,
SAFE_CAST(data_avaliacao_pnass_mes AS INT64) data_avaliacao_pnass_mes,
SAFE_CAST(gestao_basica_amb_estadual AS STRING) gestao_basica_amb_estadual,
SAFE_CAST(gestao_basica_amb_municipal AS STRING) gestao_basica_amb_municipal,
SAFE_CAST(gestao_media_amb_estadual AS STRING) gestao_media_amb_estadual,
SAFE_CAST(gestao_media_amb_municipal AS STRING) gestao_media_amb_municipal,
SAFE_CAST(gestao_alta_amb_estadual AS STRING) gestao_alta_amb_estadual,
SAFE_CAST(gestao_alta_amb_municipal AS STRING) gestao_alta_amb_municipal,
SAFE_CAST(atencao_amb AS STRING) atencao_amb,
SAFE_CAST(gestao_estadual AS STRING) gestao_estadual,
SAFE_CAST(gestao_municipal AS STRING) gestao_municipal,
SAFE_CAST(gestao_media_hosp_estadual AS STRING) gestao_media_hosp_estadual,
SAFE_CAST(gestao_media_hosp_municipal AS STRING) gestao_media_hosp_municipal,
SAFE_CAST(gestao_alta_hosp_estadual AS STRING) gestao_alta_hosp_estadual,
SAFE_CAST(gestao_alta_hosp_municipal AS STRING) gestao_alta_hosp_municipal,
SAFE_CAST(atencao_hosp AS STRING) atencao_hosp,
SAFE_CAST(quantidade_leitos_cirurgico AS INT64) quantidade_leitos_cirurgico,
SAFE_CAST(quantidade_leitos_clinico AS INT64) quantidade_leitos_clinico,
SAFE_CAST(quantidade_leitos_complementar AS INT64) quantidade_leitos_complementar,
SAFE_CAST(indicador_leitos_hosp AS STRING) indicador_leitos_hosp,
SAFE_CAST(quantidade_consultorio_pediatrico AS INT64) quantidade_consultorio_pediatrico,
SAFE_CAST(quantidade_consultorio_feminino AS INT64) quantidade_consultorio_feminino,
SAFE_CAST(quantidade_consultorio_masculino AS INT64) quantidade_consultorio_masculino,
SAFE_CAST(quantidade_consultorio_indiferenciado AS INT64) quantidade_consultorio_indiferenciado,
SAFE_CAST(quantidade_sala_repouso_pediatrico_urgencia AS INT64) quantidade_sala_repouso_pediatrico_urgencia,
SAFE_CAST(quantidade_sala_repouso_feminino_urgencia AS INT64) quantidade_sala_repouso_feminino_urgencia,
SAFE_CAST(quantidade_sala_repouso_masculino_urgencia AS INT64) quantidade_sala_repouso_masculino_urgencia,
SAFE_CAST(quantidade_sala_repouso_indiferenciado_urgencia AS INT64) quantidade_sala_repouso_indiferenciado_urgencia,
SAFE_CAST(quantidade_consultorio_odontologia_urgencia AS INT64) quantidade_consultorio_odontologia_urgencia,
SAFE_CAST(quantidade_sala_higienizacao_urgencia AS INT64) quantidade_sala_higienizacao_urgencia,
SAFE_CAST(quantidade_sala_gesso_urgencia AS INT64) quantidade_sala_gesso_urgencia,
SAFE_CAST(quantidade_sala_curativo_urgencia AS INT64) quantidade_sala_curativo_urgencia,
SAFE_CAST(quantidade_sala_pequena_cirurgia_urgencia AS INT64) quantidade_sala_pequena_cirurgia_urgencia,
SAFE_CAST(quantidade_consultorio_medico_urgencia AS INT64) quantidade_consultorio_medico_urgencia,
SAFE_CAST(indicador_instalacao_urgencia AS STRING) indicador_instalacao_urgencia,
SAFE_CAST(quantidade_consultorio_clinica_basica AS INT64) quantidade_consultorio_clinica_basica,
SAFE_CAST(quantidade_consultorio_clinica_especializada AS INT64) quantidade_consultorio_clinica_especializada,
SAFE_CAST(quantidade_consultorio_clinica_indiferenciada AS INT64) quantidade_consultorio_clinica_indiferenciada,
SAFE_CAST(quantidade_consultorio_nao_medico AS INT64) quantidade_consultorio_nao_medico,
SAFE_CAST(quantidade_sala_repouso_feminino_amb AS INT64) quantidade_sala_repouso_feminino_amb,
SAFE_CAST(quantidade_sala_repouso_masculino_amb AS INT64) quantidade_sala_repouso_masculino_amb,
SAFE_CAST(quantidade_sala_repouso_pediatrico_amb AS INT64) quantidade_sala_repouso_pediatrico_amb,
SAFE_CAST(quantidade_sala_repouso_indiferenciado_amb AS INT64) quantidade_sala_repouso_indiferenciado_amb,
SAFE_CAST(quantidade_consultorio_odontologia_amb AS INT64) quantidade_consultorio_odontologia_amb,
SAFE_CAST(quantidade_sala_pequena_cirurgia_amb AS INT64) quantidade_sala_pequena_cirurgia_amb,
SAFE_CAST(quantidade_sala_enfermagem_amb AS INT64) quantidade_sala_enfermagem_amb,
SAFE_CAST(quantidade_sala_imunizacao_amb AS INT64) quantidade_sala_imunizacao_amb,
SAFE_CAST(quantidade_sala_nebulizacao_amb AS INT64) quantidade_sala_nebulizacao_amb,
SAFE_CAST(quantidade_sala_gesso_amb AS INT64) quantidade_sala_gesso_amb,
SAFE_CAST(quantidade_sala_curativo_amb AS INT64) quantidade_sala_curativo_amb,
SAFE_CAST(quantidade_sala_cirurgia_amb AS INT64) quantidade_sala_cirurgia_amb,
SAFE_CAST(indicador_instalcao_ambulatorial AS STRING) indicador_instalcao_ambulatorial,
SAFE_CAST(quantidade_sala_cirurgia AS INT64) quantidade_sala_cirurgia,
SAFE_CAST(quantidade_sala_recuperacao AS INT64) quantidade_sala_recuperacao,
SAFE_CAST(quantidade_sala_cirurgia_amb_centro_cirurgico AS INT64) quantidade_sala_cirurgia_amb_centro_cirurgico,
SAFE_CAST(indicador_instalacao_centro_cirurgico AS STRING) indicador_instalacao_centro_cirurgico,
SAFE_CAST(quantidade_sala_pre_parto AS INT64) quantidade_sala_pre_parto,
SAFE_CAST(quantidade_sala_parto_normal AS INT64) quantidade_sala_parto_normal,
SAFE_CAST(quantidade_sala_curetagem AS INT64) quantidade_sala_curetagem,
SAFE_CAST(quantidade_sala_cirurgia_centro_obstetrico AS INT64) quantidade_sala_cirurgia_centro_obstetrico,
SAFE_CAST(indicador_instalacao_centro_obstetrico AS STRING) indicador_instalacao_centro_obstetrico,
SAFE_CAST(quantidade_leito_repouso_pediatrico_urgencia AS INT64) quantidade_leito_repouso_pediatrico_urgencia,
SAFE_CAST(quantidade_leito_repouso_feminino_urgencia AS INT64) quantidade_leito_repouso_feminino_urgencia,
SAFE_CAST(quantidade_leito_repouso_masculino_urgencia AS INT64) quantidade_leito_repouso_masculino_urgencia,
SAFE_CAST(quantidade_leito_repouso_indiferenciado_urgencia AS INT64) quantidade_leito_repouso_indiferenciado_urgencia,
SAFE_CAST(quantidade_equipos_odontologia_urgencia AS INT64) quantidade_equipos_odontologia_urgencia,
SAFE_CAST(quantidade_leito_repouso_feminino_amb AS INT64) quantidade_leito_repouso_feminino_amb,
SAFE_CAST(quantidade_leito_repouso_masculino_amb AS INT64) quantidade_leito_repouso_masculino_amb,
SAFE_CAST(quantidade_leito_repouso_pediatrico_amb AS INT64) quantidade_leito_repouso_pediatrico_amb,
SAFE_CAST(quantidade_leito_repouso_indiferenciado_amb AS INT64) quantidade_leito_repouso_indiferenciado_amb,
SAFE_CAST(quantidade_equipos_odontologia_amb AS INT64) quantidade_equipos_odontologia_amb,
SAFE_CAST(quantidade_leito_recuperacao_centro_cirurgico AS INT64) quantidade_leito_recuperacao_centro_cirurgico,
SAFE_CAST(quantidade_leito_pre_parto AS INT64) quantidade_leito_pre_parto,
SAFE_CAST(quantidade_leito_recem_nascido_normal AS INT64) quantidade_leito_recem_nascido_normal,
SAFE_CAST(quantidade_leito_recem_nascido_patologico AS INT64) quantidade_leito_recem_nascido_patologico,
SAFE_CAST(quantidade_leito_conjunto_neonatal AS INT64) quantidade_leito_conjunto_neonatal,
SAFE_CAST(indicador_instalacao_neonatal AS STRING) indicador_instalacao_neonatal,
SAFE_CAST(indicador_instalaco_hospitalar AS STRING) indicador_instalaco_hospitalar,
SAFE_CAST(servico_apoio_proprio AS STRING) servico_apoio_proprio,
SAFE_CAST(servico_apoio_terceirizado AS STRING) servico_apoio_terceirizado,
SAFE_CAST(servico_social_proprio AS STRING) servico_social_proprio,
SAFE_CAST(servico_social_terceirizado AS STRING) servico_social_terceirizado,
SAFE_CAST(servico_farmacia_proprio AS STRING) servico_farmacia_proprio,
SAFE_CAST(servico_farmacia_terceirizado AS STRING) servico_farmacia_terceirizado,
SAFE_CAST(servico_esterilizacao_proprio AS STRING) servico_esterilizacao_proprio,
SAFE_CAST(servico_esterilizacao_terceirizado AS STRING) servico_esterilizacao_terceirizado,
SAFE_CAST(servico_nutricao_proprio AS STRING) servico_nutricao_proprio,
SAFE_CAST(servico_nutricao_terceirizado AS STRING) servico_nutricao_terceirizado,
SAFE_CAST(servico_lactario_proprio AS STRING) servico_lactario_proprio,
SAFE_CAST(servico_lactario_terceirizado AS STRING) servico_lactario_terceirizado,
SAFE_CAST(servico_banco_leite_proprio AS STRING) servico_banco_leite_proprio,
SAFE_CAST(servico_banco_leite_terceirizado AS STRING) servico_banco_leite_terceirizado,
SAFE_CAST(servico_lavanderia_proprio AS STRING) servico_lavanderia_proprio,
SAFE_CAST(servico_lavanderia_terceirizado AS STRING) servico_lavanderia_terceirizado,
SAFE_CAST(servico_manutencao_proprio AS STRING) servico_manutencao_proprio,
SAFE_CAST(servico_manutencao_terceirizado AS STRING) servico_manutencao_terceirizado,
SAFE_CAST(servico_ambulancia_proprio AS STRING) servico_ambulancia_proprio,
SAFE_CAST(servico_ambulancia_terceirizado AS STRING) servico_ambulancia_terceirizado,
SAFE_CAST(servico_necroterio_proprio AS STRING) servico_necroterio_proprio,
SAFE_CAST(servico_necroterio_terceirizado AS STRING) servico_necroterio_terceirizado,
SAFE_CAST(indicador_servico_apoio AS STRING) indicador_servico_apoio,
SAFE_CAST(coleta_residuo_biologico AS STRING) coleta_residuo_biologico,
SAFE_CAST(coleta_residuo_quimico AS STRING) coleta_residuo_quimico,
SAFE_CAST(coleta_rejeito_radioativo AS STRING) coleta_rejeito_radioativo,
SAFE_CAST(coleta_rejeito_comum AS STRING) coleta_rejeito_comum,
SAFE_CAST(indicador_coleta_residuo AS STRING) indicador_coleta_residuo,
SAFE_CAST(comissao_etica_medica AS STRING) comissao_etica_medica,
SAFE_CAST(comissao_etica_enfermagem AS STRING) comissao_etica_enfermagem,
SAFE_CAST(comissao_farmacia_terapeutica AS STRING) comissao_farmacia_terapeutica,
SAFE_CAST(comissao_controle_infeccao AS STRING) comissao_controle_infeccao,
SAFE_CAST(comissao_apropriacao_custos AS STRING) comissao_apropriacao_custos,
SAFE_CAST(comissao_cipa AS STRING) comissao_cipa,
SAFE_CAST(comissao_revisao_prontuario AS STRING) comissao_revisao_prontuario,
SAFE_CAST(comissao_revisao_documentacao AS STRING) comissao_revisao_documentacao,
SAFE_CAST(comissao_analise_obito_biopisias AS STRING) comissao_analise_obito_biopisias,
SAFE_CAST(comissao_investigacao_epidemiologica AS STRING) comissao_investigacao_epidemiologica,
SAFE_CAST(comissao_notificacao_doencas AS STRING) comissao_notificacao_doencas,
SAFE_CAST(comissao_zoonose_vetores AS STRING) comissao_zoonose_vetores,
SAFE_CAST(indicador_comissao AS STRING) indicador_comissao,
SAFE_CAST(atendimento_internacao_sus AS STRING) atendimento_internacao_sus,
SAFE_CAST(atendimento_internacao_particular AS STRING) atendimento_internacao_particular,
SAFE_CAST(atendimento_internacao_plano_seguro_proprio AS STRING) atendimento_internacao_plano_seguro_proprio,
SAFE_CAST(atendimento_internacao_plano_seguro_terceiro AS STRING) atendimento_internacao_plano_seguro_terceiro,
SAFE_CAST(atendimento_internacao_plano_saude_publico AS STRING) atendimento_internacao_plano_saude_publico,
SAFE_CAST(atendimento_internacao_plano_saude_privado AS STRING) atendimento_internacao_plano_saude_privado,
SAFE_CAST(atendimento_amb_sus AS STRING) atendimento_amb_sus,
SAFE_CAST(atendimento_amb_particular AS STRING) atendimento_amb_particular,
SAFE_CAST(atendimento_amb_plano_seguro_proprio AS STRING) atendimento_amb_plano_seguro_proprio,
SAFE_CAST(atendimento_amb_plano_seguro_terceiro AS STRING) atendimento_amb_plano_seguro_terceiro,
SAFE_CAST(atendimento_amb_plano_saude_publico AS STRING) atendimento_amb_plano_saude_publico,
SAFE_CAST(atendimento_amb_plano_saude_privado AS STRING) atendimento_amb_plano_saude_privado,
SAFE_CAST(atendimento_sadt_sus AS STRING) atendimento_sadt_sus,
SAFE_CAST(atendimento_sadt_privado AS STRING) atendimento_sadt_privado,
SAFE_CAST(atendimento_sadt_plano_seguro_proprio AS STRING) atendimento_sadt_plano_seguro_proprio,
SAFE_CAST(atendimento_sadt_plano_seguro_terceiro AS STRING) atendimento_sadt_plano_seguro_terceiro,
SAFE_CAST(atendimento_sadt_plano_saude_publico AS STRING) atendimento_sadt_plano_saude_publico,
SAFE_CAST(atendimento_sadt_plano_saude_privado AS STRING) atendimento_sadt_plano_saude_privado,
SAFE_CAST(atendimento_urgencia_sus AS STRING) atendimento_urgencia_sus,
SAFE_CAST(atendimento_urgencia_privado AS STRING) atendimento_urgencia_privado,
SAFE_CAST(atendimento_urgencia_plano_seguro_proprio AS STRING) atendimento_urgencia_plano_seguro_proprio,
SAFE_CAST(atendimento_urgencia_plano_seguro_terceiro AS STRING) atendimento_urgencia_plano_seguro_terceiro,
SAFE_CAST(atendimento_urgencia_plano_saude_publico AS STRING) atendimento_urgencia_plano_saude_publico,
SAFE_CAST(atendimento_urgencia_plano_saude_privado AS STRING) atendimento_urgencia_plano_saude_privado,
SAFE_CAST(atendimento_outros_sus AS STRING) atendimento_outros_sus,
SAFE_CAST(atendimento_outros_privado AS STRING) atendimento_outros_privado,
SAFE_CAST(atendimento_outros_plano_seguro_proprio AS STRING) atendimento_outros_plano_seguro_proprio,
SAFE_CAST(atendimento_outros_plano_seguro_terceiro AS STRING) atendimento_outros_plano_seguro_terceiro,
SAFE_CAST(atendimento_outros_plano_saude_publico AS STRING) atendimento_outros_plano_saude_publico,
SAFE_CAST(atendimento_outros_plano_saude_privado AS STRING) atendimento_outros_plano_saude_privado,
SAFE_CAST(atendimento_vigilancia_sus AS STRING) atendimento_vigilancia_sus,
SAFE_CAST(atendimento_vigilancia_privado AS STRING) atendimento_vigilancia_privado,
SAFE_CAST(atendimento_vigilancia_plano_seguro_proprio AS STRING) atendimento_vigilancia_plano_seguro_proprio,
SAFE_CAST(atendimento_vigilancia_plano_seguro_terceiro AS STRING) atendimento_vigilancia_plano_seguro_terceiro,
SAFE_CAST(atendimento_vigilancia_plano_saude_publico AS STRING) atendimento_vigilancia_plano_saude_publico,
SAFE_CAST(atendimento_vigilancia_plano_saude_privado AS STRING) atendimento_vigilancia_plano_saude_privado,
SAFE_CAST(atendimento_regulacao_sus AS STRING) atendimento_regulacao_sus,
SAFE_CAST(atendimento_regulacao_privado AS STRING) atendimento_regulacao_privado,
SAFE_CAST(atendimento_regulacao_plano_seguro_proprio AS STRING) atendimento_regulacao_plano_seguro_proprio,
SAFE_CAST(atendimento_regulacao_plano_seguro_terceiro AS STRING) atendimento_regulacao_plano_seguro_terceiro,
SAFE_CAST(atendimento_regulacao_plano_saude_publico AS STRING) atendimento_regulacao_plano_saude_publico,
SAFE_CAST(atendimento_regulacao_plano_saude_privado AS STRING) atendimento_regulacao_plano_saude_privado,
SAFE_CAST(indicador_atendimento_prestado AS STRING) indicador_atendimento_prestado,
SAFE_CAST(data_atualizacao_ano AS INT64) data_atualizacao_ano,
SAFE_CAST(data_atualizacao_mes AS INT64) data_atualizacao_mes,
SAFE_CAST(data_competencia_ano AS INT64) data_competencia_ano,
SAFE_CAST(data_competencia_mes AS INT64) data_competencia_mes,
SAFE_CAST(natureza_juridica AS STRING) natureza_juridica
from basedosdados-dev.br_ms_cnes_staging.estabelecimento as t