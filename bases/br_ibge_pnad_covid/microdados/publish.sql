/*

Query para publicar a tabela.

Esse é o lugar para:
    - modificar nomes, ordem e tipos de colunas
    - dar join com outras tabelas
    - criar colunas extras (e.g. logs, proporções, etc.)

Qualquer coluna definida aqui deve também existir em `table_config.yaml`.

# Além disso, sinta-se à vontade para alterar alguns nomes obscuros
# para algo um pouco mais explícito.

TIPOS:
    - Para modificar tipos de colunas, basta substituir STRING por outro tipo válido.
    - Exemplo: `SAFE_CAST(column_name AS NUMERIC) column_name`
    - Mais detalhes: https://cloud.google.com/bigquery/docs/reference/standard-sql/data-types

*/
CREATE VIEW basedosdados-dev.br_ibge_pnad_covid.microdados AS
SELECT 
SAFE_CAST(ano AS INT64) ano,
SAFE_CAST(mes AS INT64) mes,
SAFE_CAST(semana AS INT64) semana,
SAFE_CAST(sigla_uf AS STRING) sigla_uf,
SAFE_CAST(capital AS STRING) capital,
SAFE_CAST(rm_ride AS STRING) rm_ride,
SAFE_CAST(estrato AS STRING) estrato,
SAFE_CAST(upa AS STRING) upa,
SAFE_CAST(v1008 AS INT64) v1008,
SAFE_CAST(v1016 AS INT64) v1016,
SAFE_CAST(v1022 AS STRING) v1022,
SAFE_CAST(v1023 AS STRING) v1023,
SAFE_CAST(v1030 AS INT64) v1030,
SAFE_CAST(v1031 AS FLOAT64) v1031,
SAFE_CAST(v1032 AS FLOAT64) v1032,
SAFE_CAST(posest AS STRING) posest,
SAFE_CAST(a001 AS INT64) a001,
SAFE_CAST(a001a AS STRING) a001a,
SAFE_CAST(a001b1 AS INT64) a001b1,
SAFE_CAST(a001b2 AS INT64) a001b2,
SAFE_CAST(a001b3 AS INT64) a001b3,
SAFE_CAST(a002 AS STRING) a002,
SAFE_CAST(a003 AS STRING) a003,
SAFE_CAST(a004 AS STRING) a004,
SAFE_CAST(a005 AS STRING) a005,
SAFE_CAST(a006 AS STRING) a006,
SAFE_CAST(a006a AS STRING) a006a,
SAFE_CAST(a006b AS STRING) a006b,
SAFE_CAST(a007 AS STRING) a007,
SAFE_CAST(a007a AS STRING) a007a,
SAFE_CAST(a008 AS STRING) a008,
SAFE_CAST(a009 AS STRING) a009,
SAFE_CAST(b0011 AS STRING) b0011,
SAFE_CAST(b0012 AS STRING) b0012,
SAFE_CAST(b0013 AS STRING) b0013,
SAFE_CAST(b0014 AS STRING) b0014,
SAFE_CAST(b0015 AS STRING) b0015,
SAFE_CAST(b0016 AS STRING) b0016,
SAFE_CAST(b0017 AS STRING) b0017,
SAFE_CAST(b0018 AS STRING) b0018,
SAFE_CAST(b0019 AS STRING) b0019,
SAFE_CAST(b00110 AS STRING) b00110,
SAFE_CAST(b00111 AS STRING) b00111,
SAFE_CAST(b00112 AS STRING) b00112,
SAFE_CAST(b00113 AS STRING) b00113,
SAFE_CAST(b002 AS STRING) b002,
SAFE_CAST(b0031 AS STRING) b0031,
SAFE_CAST(b0032 AS STRING) b0032,
SAFE_CAST(b0033 AS STRING) b0033,
SAFE_CAST(b0034 AS STRING) b0034,
SAFE_CAST(b0035 AS STRING) b0035,
SAFE_CAST(b0036 AS STRING) b0036,
SAFE_CAST(b0037 AS STRING) b0037,
SAFE_CAST(b0041 AS STRING) b0041,
SAFE_CAST(b0042 AS STRING) b0042,
SAFE_CAST(b0043 AS STRING) b0043,
SAFE_CAST(b0044 AS STRING) b0044,
SAFE_CAST(b0045 AS STRING) b0045,
SAFE_CAST(b0046 AS STRING) b0046,
SAFE_CAST(b005 AS STRING) b005,
SAFE_CAST(b006 AS STRING) b006,
SAFE_CAST(b007 AS STRING) b007,
SAFE_CAST(b008 AS STRING) b008,
SAFE_CAST(b009a AS STRING) b009a,
SAFE_CAST(b009b AS STRING) b009b,
SAFE_CAST(b009c AS STRING) b009c,
SAFE_CAST(b009d AS STRING) b009d,
SAFE_CAST(b009e AS STRING) b009e,
SAFE_CAST(b009f AS STRING) b009f,
SAFE_CAST(b0101 AS STRING) b0101,
SAFE_CAST(b0102 AS STRING) b0102,
SAFE_CAST(b0103 AS STRING) b0103,
SAFE_CAST(b0104 AS STRING) b0104,
SAFE_CAST(b0105 AS STRING) b0105,
SAFE_CAST(b0106 AS STRING) b0106,
SAFE_CAST(b011 AS STRING) b011,
SAFE_CAST(c001 AS STRING) c001,
SAFE_CAST(c002 AS STRING) c002,
SAFE_CAST(c003 AS STRING) c003,
SAFE_CAST(c004 AS STRING) c004,
SAFE_CAST(c005 AS STRING) c005,
SAFE_CAST(c0051 AS INT64) c0051,
SAFE_CAST(c0052 AS INT64) c0052,
SAFE_CAST(c0053 AS INT64) c0053,
SAFE_CAST(c006 AS STRING) c006,
SAFE_CAST(c007 AS STRING) c007,
SAFE_CAST(c007a AS STRING) c007a,
SAFE_CAST(c007b AS STRING) c007b,
SAFE_CAST(c007c AS STRING) c007c,
SAFE_CAST(c007d AS STRING) c007d,
SAFE_CAST(c007e AS STRING) c007e,
SAFE_CAST(c007e1 AS INT64) c007e1,
SAFE_CAST(c007e2 AS INT64) c007e2,
SAFE_CAST(c007f AS STRING) c007f,
SAFE_CAST(c008 AS INT64) c008,
SAFE_CAST(c009 AS INT64) c009,
SAFE_CAST(c009a AS STRING) c009a,
SAFE_CAST(c010 AS STRING) c010,
SAFE_CAST(c0101 AS STRING) c0101,
SAFE_CAST(c01011 AS STRING) c01011,
SAFE_CAST(c01012 AS FLOAT64) c01012,
SAFE_CAST(c0102 AS STRING) c0102,
SAFE_CAST(c01021 AS STRING) c01021,
SAFE_CAST(c01022 AS FLOAT64) c01022,
SAFE_CAST(c0103 AS STRING) c0103,
SAFE_CAST(c0104 AS STRING) c0104,
SAFE_CAST(c011a AS STRING) c011a,
SAFE_CAST(c011a1 AS STRING) c011a1,
SAFE_CAST(c011a11 AS STRING) c011a11,
SAFE_CAST(c011a12 AS FLOAT64) c011a12,
SAFE_CAST(c011a2 AS STRING) c011a2,
SAFE_CAST(c011a21 AS STRING) c011a21,
SAFE_CAST(c011a22 AS FLOAT64) c011a22,
SAFE_CAST(c012 AS STRING) c012,
SAFE_CAST(c013 AS STRING) c013,
SAFE_CAST(c014 AS STRING) c014,
SAFE_CAST(c015 AS STRING) c015,
SAFE_CAST(c016 AS STRING) c016,
SAFE_CAST(c017a AS STRING) c017a,
SAFE_CAST(d0011 AS STRING) d0011,
SAFE_CAST(d0013 AS FLOAT64) d0013,
SAFE_CAST(d0021 AS STRING) d0021,
SAFE_CAST(d0023 AS FLOAT64) d0023,
SAFE_CAST(d0031 AS STRING) d0031,
SAFE_CAST(d0033 AS FLOAT64) d0033,
SAFE_CAST(d0041 AS STRING) d0041,
SAFE_CAST(d0043 AS FLOAT64) d0043,
SAFE_CAST(d0051 AS STRING) d0051,
SAFE_CAST(d0053 AS FLOAT64) d0053,
SAFE_CAST(d0061 AS STRING) d0061,
SAFE_CAST(d0063 AS FLOAT64) d0063,
SAFE_CAST(d0071 AS STRING) d0071,
SAFE_CAST(d0073 AS FLOAT64) d0073,
SAFE_CAST(e001 AS STRING) e001,
SAFE_CAST(e0021 AS STRING) e0021,
SAFE_CAST(e0022 AS STRING) e0022,
SAFE_CAST(e0023 AS STRING) e0023,
SAFE_CAST(e0024 AS STRING) e0024,
SAFE_CAST(f001 AS STRING) f001,
SAFE_CAST(f0021 AS FLOAT64) f0021,
SAFE_CAST(f0022 AS STRING) f0022,
SAFE_CAST(f002a1 AS STRING) f002a1,
SAFE_CAST(f002a2 AS STRING) f002a2,
SAFE_CAST(f002a3 AS STRING) f002a3,
SAFE_CAST(f002a4 AS STRING) f002a4,
SAFE_CAST(f002a5 AS STRING) f002a5,
SAFE_CAST(f0061 AS STRING) f0061,
SAFE_CAST(f006 AS INT64) f006
FROM basedosdados-dev.br_ibge_pnad_covid_staging.microdados AS t