/*
Query para publicar a tabela.

Esse é o lugar para:
    - modificar nomes, ordem e tipos de colunas
    - dar join com outras tabelas
    - criar colunas extras (e.g. logs, proporções, etc.)

Qualquer coluna definida aqui deve também existir em `table_config.yaml`.

# Além disso, sinta-se à vontade para alterar alguns nomes obscuros
# para algo um pouco mais explícito.

TIPOS:
    - Para modificar tipos de colunas, basta substituir STRING por outro tipo válido.
    - Exemplo: `SAFE_CAST(column_name AS NUMERIC) column_name`
    - Mais detalhes: https://cloud.google.com/bigquery/docs/reference/standard-sql/data-types
*/

CREATE VIEW basedosdados-dev.br_mdr_snis.municipio_agua_esgoto AS
SELECT 
SAFE_CAST(ano AS INT64) ano,
SAFE_CAST(id_municipio AS STRING) id_municipio,
SAFE_CAST(sigla_uf AS STRING) sigla_uf,
SAFE_CAST(populacao_atendida_agua AS INT64) populacao_atendida_agua,
SAFE_CAST(populacao_atentida_esgoto AS INT64) populacao_atentida_esgoto,
SAFE_CAST(populacao_urbana AS INT64) populacao_urbana,
SAFE_CAST(populacao_urbana_residente_agua AS INT64) populacao_urbana_residente_agua,
SAFE_CAST(populacao_urbana_atendida_agua AS INT64) populacao_urbana_atendida_agua,
SAFE_CAST(populacao_urbana_atendida_agua_ibge AS INT64) populacao_urbana_atendida_agua_ibge,
SAFE_CAST(populacao_urbana_residente_esgoto AS INT64) populacao_urbana_residente_esgoto,
SAFE_CAST(populacao_urbana_atendida_esgoto AS INT64) populacao_urbana_atendida_esgoto,
SAFE_CAST(populacao_urbana_residente_esgoto_ibge AS INT64) populacao_urbana_residente_esgoto_ibge,
SAFE_CAST(extensao_rede_agua AS FLOAT64) extensao_rede_agua,
SAFE_CAST(extensao_rede_esgoto AS FLOAT64) extensao_rede_esgoto,
SAFE_CAST(quantidade_sede_municipal_agua AS INT64) quantidade_sede_municipal_agua,
SAFE_CAST(quantidade_sede_municipal_esgoto AS INT64) quantidade_sede_municipal_esgoto,
SAFE_CAST(quantidade_localidade_agua AS INT64) quantidade_localidade_agua,
SAFE_CAST(quantidade_localidade_esgoto AS INT64) quantidade_localidade_esgoto,
SAFE_CAST(quantidade_ligacao_ativa_agua AS INT64) quantidade_ligacao_ativa_agua,
SAFE_CAST(quantidade_ligacao_ativa_esgoto AS INT64) quantidade_ligacao_ativa_esgoto,
SAFE_CAST(quantidade_ligacao_total_agua AS INT64) quantidade_ligacao_total_agua,
SAFE_CAST(quantidade_ligacao_total_esgoto AS INT64) quantidade_ligacao_total_esgoto,
SAFE_CAST(quantidade_economia_ativa_agua AS INT64) quantidade_economia_ativa_agua,
SAFE_CAST(quantidade_economia_ativa_esgoto AS INT64) quantidade_economia_ativa_esgoto,
SAFE_CAST(quantidade_ligacao_micromedia_ativa_agua AS INT64) quantidade_ligacao_micromedia_ativa_agua,
SAFE_CAST(quantidade_economia_residencial_ativa_agua AS INT64) quantidade_economia_residencial_ativa_agua,
SAFE_CAST(quantidade_economia_residencial_ativa_esgoto AS INT64) quantidade_economia_residencial_ativa_esgoto,
SAFE_CAST(quantidade_economia_micromedida_ativa_agua AS INT64) quantidade_economia_micromedida_ativa_agua,
SAFE_CAST(quantidade_economia_residencial_micromedida_ativa_agua AS INT64) quantidade_economia_residencial_micromedida_ativa_agua,
SAFE_CAST(volume_agua_produzido AS FLOAT64) volume_agua_produzido,
SAFE_CAST(volume_agua_tratada_eta AS FLOAT64) volume_agua_tratada_eta,
SAFE_CAST(volume_agua_micromedido AS FLOAT64) volume_agua_micromedido,
SAFE_CAST(volume_agua_consumido AS FLOAT64) volume_agua_consumido,
SAFE_CAST(volume_agua_faturado AS FLOAT64) volume_agua_faturado,
SAFE_CAST(volume_agua_macromedido AS FLOAT64) volume_agua_macromedido,
SAFE_CAST(volume_agua_tratada_desinfeccao AS FLOAT64) volume_agua_tratada_desinfeccao,
SAFE_CAST(volume_agua_bruta_exportado AS FLOAT64) volume_agua_bruta_exportado,
SAFE_CAST(volume_agua_tratada_importado AS FLOAT64) volume_agua_tratada_importado,
SAFE_CAST(volume_agua_tratada_exportado AS FLOAT64) volume_agua_tratada_exportado,
SAFE_CAST(volume_agua_micromedido_economia_ativa AS FLOAT64) volume_agua_micromedido_economia_ativa,
SAFE_CAST(volume_servico_agua AS FLOAT64) volume_servico_agua,
SAFE_CAST(volume_agua_fluoretada AS FLOAT64) volume_agua_fluoretada,
SAFE_CAST(consumo_eletrico_sistemas_agua AS FLOAT64) consumo_eletrico_sistemas_agua,
SAFE_CAST(volume_esgoto_coletado AS FLOAT64) volume_esgoto_coletado,
SAFE_CAST(volume_esgoto_tratado AS FLOAT64) volume_esgoto_tratado,
SAFE_CAST(volume_esgoto_faturado AS FLOAT64) volume_esgoto_faturado,
SAFE_CAST(volume_esgoto_bruto_exportado AS FLOAT64) volume_esgoto_bruto_exportado,
SAFE_CAST(volume_esgoto_bruto_importado AS FLOAT64) volume_esgoto_bruto_importado,
SAFE_CAST(volume_esgoto_importado AS FLOAT64) volume_esgoto_importado,
SAFE_CAST(volume_esgoto_bruto_exportado_tratamento_importador AS FLOAT64) volume_esgoto_bruto_exportado_tratamento_importador,
SAFE_CAST(consumo_eletrico_sistemas_esgoto AS FLOAT64) consumo_eletrico_sistemas_esgoto,
SAFE_CAST(indice_agua_ligacao AS FLOAT64) indice_agua_ligacao,
SAFE_CAST(indice_hidrometracao AS FLOAT64) indice_hidrometracao,
SAFE_CAST(indice_macromedicao_volume_disponibilizado AS FLOAT64) indice_macromedicao_volume_disponibilizado,
SAFE_CAST(indice_macromedicao AS FLOAT64) indice_macromedicao,
SAFE_CAST(indice_perda_faturamento AS FLOAT64) indice_perda_faturamento,
SAFE_CAST(indice_micromedido_economia AS FLOAT64) indice_micromedido_economia,
SAFE_CAST(indice_coleta_esgoto AS FLOAT64) indice_coleta_esgoto,
SAFE_CAST(indice_tratamento_esgoto AS FLOAT64) indice_tratamento_esgoto,
SAFE_CAST(indice_consumo_agua_faturado AS FLOAT64) indice_consumo_agua_faturado,
SAFE_CAST(indice_extensao_agua_ligacao AS FLOAT64) indice_extensao_agua_ligacao,
SAFE_CAST(indice_extensao_esgoto_ligacao AS FLOAT64) indice_extensao_esgoto_ligacao,
SAFE_CAST(indice_consumo_agua_per_capita AS FLOAT64) indice_consumo_agua_per_capita,
SAFE_CAST(indice_atendimento_urbano_agua AS FLOAT64) indice_atendimento_urbano_agua,
SAFE_CAST(indice_atendimento_agua_esgoto AS FLOAT64) indice_atendimento_agua_esgoto,
SAFE_CAST(indice_volume_agua_economia AS FLOAT64) indice_volume_agua_economia,
SAFE_CAST(indice_faturamento_agua AS FLOAT64) indice_faturamento_agua,
SAFE_CAST(indice_participacao_economia_agua AS FLOAT64) indice_participacao_economia_agua,
SAFE_CAST(indice_micromedicao_relativo_agua AS FLOAT64) indice_micromedicao_relativo_agua,
SAFE_CAST(indice_esgotamento_agua_consumida AS FLOAT64) indice_esgotamento_agua_consumida,
SAFE_CAST(indice_atendimento_esgoto_esgoto AS FLOAT64) indice_atendimento_esgoto_esgoto,
SAFE_CAST(indice_perda_distribuicao_agua AS FLOAT64) indice_perda_distribuicao_agua,
SAFE_CAST(indice_perda_linear_agua AS FLOAT64) indice_perda_linear_agua,
SAFE_CAST(indice_perda_ligacao_agua AS FLOAT64) indice_perda_ligacao_agua,
SAFE_CAST(indice_consumo_agua AS FLOAT64) indice_consumo_agua,
SAFE_CAST(indice_consumo_medio_agua AS FLOAT64) indice_consumo_medio_agua,
SAFE_CAST(indice_atendimento_total_agua AS FLOAT64) indice_atendimento_total_agua,
SAFE_CAST(indice_atendimento_esgoto_agua AS FLOAT64) indice_atendimento_esgoto_agua,
SAFE_CAST(indice_fluoretacao_agua AS FLOAT64) indice_fluoretacao_agua,
SAFE_CAST(indice_consumo_energia_agua AS FLOAT64) indice_consumo_energia_agua,
SAFE_CAST(indice_consumo_energia_esgoto AS FLOAT64) indice_consumo_energia_esgoto,
SAFE_CAST(receita_operacional_direta AS FLOAT64) receita_operacional_direta,
SAFE_CAST(receita_operacional_direta_agua AS FLOAT64) receita_operacional_direta_agua,
SAFE_CAST(receita_operacional_direta_esgoto AS FLOAT64) receita_operacional_direta_esgoto,
SAFE_CAST(receita_operacional_indireta AS FLOAT64) receita_operacional_indireta,
SAFE_CAST(receita_operacional_direta_agua_exportada AS FLOAT64) receita_operacional_direta_agua_exportada,
SAFE_CAST(receita_operacional AS FLOAT64) receita_operacional,
SAFE_CAST(receita_operacional_direta_esgoto_importado AS FLOAT64) receita_operacional_direta_esgoto_importado,
SAFE_CAST(arrecadacao_total AS FLOAT64) arrecadacao_total,
SAFE_CAST(credito_areceber AS FLOAT64) credito_areceber,
SAFE_CAST(despesa_pessoal AS FLOAT64) despesa_pessoal,
SAFE_CAST(quantidade_empregado AS INT64) quantidade_empregado,
SAFE_CAST(despesa_produto_quimico AS FLOAT64) despesa_produto_quimico,
SAFE_CAST(despesa_energia AS FLOAT64) despesa_energia,
SAFE_CAST(despesa_servico_terceiro AS FLOAT64) despesa_servico_terceiro,
SAFE_CAST(despesa_exploracao AS FLOAT64) despesa_exploracao,
SAFE_CAST(despesas_juros_divida AS FLOAT64) despesas_juros_divida,
SAFE_CAST(despesa_total_servico AS FLOAT64) despesa_total_servico,
SAFE_CAST(despesa_ativo AS FLOAT64) despesa_ativo,
SAFE_CAST(despesa_agua_importada AS FLOAT64) despesa_agua_importada,
SAFE_CAST(despesa_fiscal AS FLOAT64) despesa_fiscal,
SAFE_CAST(despesa_fiscal_nao_computada AS FLOAT64) despesa_fiscal_nao_computada,
SAFE_CAST(despesa_exploracao_outro AS FLOAT64) despesa_exploracao_outro,
SAFE_CAST(despesa_servico_outro AS FLOAT64) despesa_servico_outro,
SAFE_CAST(despesa_amortizacao_divida AS FLOAT64) despesa_amortizacao_divida,
SAFE_CAST(despesas_juros_divida_excecao AS FLOAT64) despesas_juros_divida_excecao,
SAFE_CAST(despesa_divida_variacao AS FLOAT64) despesa_divida_variacao,
SAFE_CAST(despesa_divida_total AS FLOAT64) despesa_divida_total,
SAFE_CAST(despesa_esgoto_exportado AS FLOAT64) despesa_esgoto_exportado,
SAFE_CAST(despesa_capitalizavel_municipio AS FLOAT64) despesa_capitalizavel_municipio,
SAFE_CAST(despesa_capitalizavel_estado AS FLOAT64) despesa_capitalizavel_estado,
SAFE_CAST(despesa_capitalizavel_prestador AS FLOAT64) despesa_capitalizavel_prestador,
SAFE_CAST(investimento_agua_prestador AS FLOAT64) investimento_agua_prestador,
SAFE_CAST(investimento_esgoto_prestador AS FLOAT64) investimento_esgoto_prestador,
SAFE_CAST(investimento_outro_prestador AS FLOAT64) investimento_outro_prestador,
SAFE_CAST(investimento_recurso_proprio_prestador AS FLOAT64) investimento_recurso_proprio_prestador,
SAFE_CAST(investimento_recurso_oneroso_prestador AS FLOAT64) investimento_recurso_oneroso_prestador,
SAFE_CAST(investimento_recurso_nao_oneroso_prestador AS FLOAT64) investimento_recurso_nao_oneroso_prestador,
SAFE_CAST(investimento_total_prestador AS FLOAT64) investimento_total_prestador,
SAFE_CAST(investimento_agua_municipio AS FLOAT64) investimento_agua_municipio,
SAFE_CAST(investimento_esgoto_municipio AS FLOAT64) investimento_esgoto_municipio,
SAFE_CAST(investimento_outro_municipio AS FLOAT64) investimento_outro_municipio,
SAFE_CAST(investimento_recurso_proprio_municipio AS FLOAT64) investimento_recurso_proprio_municipio,
SAFE_CAST(investimento_recurso_oneroso_municipio AS FLOAT64) investimento_recurso_oneroso_municipio,
SAFE_CAST(investimento_recurso_nao_oneroso_municipio AS FLOAT64) investimento_recurso_nao_oneroso_municipio,
SAFE_CAST(investimento_total_municipio AS FLOAT64) investimento_total_municipio,
SAFE_CAST(investimento_agua_estado AS FLOAT64) investimento_agua_estado,
SAFE_CAST(investimento_esgoto_estado AS FLOAT64) investimento_esgoto_estado,
SAFE_CAST(investimento_outro_estado AS FLOAT64) investimento_outro_estado,
SAFE_CAST(investimento_recurso_proprio_estado AS FLOAT64) investimento_recurso_proprio_estado,
SAFE_CAST(investimento_recurso_oneroso_estado AS FLOAT64) investimento_recurso_oneroso_estado,
SAFE_CAST(investimento_recurso_nao_oneroso_estado AS FLOAT64) investimento_recurso_nao_oneroso_estado,
SAFE_CAST(investimento_total_estado AS FLOAT64) investimento_total_estado
FROM basedosdados-dev.br_mdr_snis_staging.municipio_agua_esgoto AS t