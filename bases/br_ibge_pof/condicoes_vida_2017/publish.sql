/*
Query para publicar a tabela.

Esse é o lugar para:
    - modificar nomes, ordem e tipos de colunas
    - dar join com outras tabelas
    - criar colunas extras (e.g. logs, proporções, etc.)

Qualquer coluna definida aqui deve também existir em `table_config.yaml`.

# Além disso, sinta-se à vontade para alterar alguns nomes obscuros
# para algo um pouco mais explícito.

TIPOS:
    - Para modificar tipos de colunas, basta substituir STRING por outro tipo válido.
    - Exemplo: `SAFE_CAST(column_name AS NUMERIC) column_name`
    - Mais detalhes: https://cloud.google.com/bigquery/docs/reference/standard-sql/data-types
*/

CREATE VIEW basedosdados-dev.br_ibge_pof.condicoes_vida_2017 AS
SELECT 
SAFE_CAST(sigla_uf AS STRING) sigla_uf,
SAFE_CAST(situacao AS STRING) situacao,
SAFE_CAST(id_estrato AS STRING) id_estrato,
SAFE_CAST(id_unidade_primaria_amostragem AS STRING) id_unidade_primaria_amostragem,
SAFE_CAST(id_domicilio AS STRING) id_domicilio,
SAFE_CAST(id_unidade_consumo AS STRING) id_unidade_consumo,
SAFE_CAST(id_informante AS STRING) id_informante,
SAFE_CAST(V61041 AS STRING) V61041,
SAFE_CAST(V61042 AS STRING) V61042,
SAFE_CAST(V61043 AS STRING) V61043,
SAFE_CAST(V61044 AS STRING) V61044,
SAFE_CAST(V61045 AS STRING) V61045,
SAFE_CAST(V61046 AS STRING) V61046,
SAFE_CAST(V61051 AS STRING) V61051,
SAFE_CAST(V61052 AS STRING) V61052,
SAFE_CAST(V61053 AS STRING) V61053,
SAFE_CAST(V61054 AS STRING) V61054,
SAFE_CAST(V61055 AS STRING) V61055,
SAFE_CAST(V61056 AS STRING) V61056,
SAFE_CAST(V61057 AS STRING) V61057,
SAFE_CAST(V61058 AS STRING) V61058,
SAFE_CAST(V61061 AS STRING) V61061,
SAFE_CAST(V61062 AS STRING) V61062,
SAFE_CAST(V61063 AS STRING) V61063,
SAFE_CAST(V61064 AS STRING) V61064,
SAFE_CAST(V61065 AS STRING) V61065,
SAFE_CAST(V61066 AS STRING) V61066,
SAFE_CAST(V61067 AS STRING) V61067,
SAFE_CAST(V61068 AS STRING) V61068,
SAFE_CAST(V61069 AS STRING) V61069,
SAFE_CAST(V610610 AS STRING) V610610,
SAFE_CAST(V610611 AS STRING) V610611,
SAFE_CAST(V61071 AS STRING) V61071,
SAFE_CAST(V61072 AS STRING) V61072,
SAFE_CAST(V61073 AS STRING) V61073,
SAFE_CAST(V6108 AS STRING) V6108,
SAFE_CAST(V6109 AS STRING) V6109,
SAFE_CAST(V6110 AS STRING) V6110,
SAFE_CAST(V6111 AS STRING) V6111,
SAFE_CAST(V6112 AS STRING) V6112,
SAFE_CAST(V6113 AS STRING) V6113,
SAFE_CAST(V6114 AS STRING) V6114,
SAFE_CAST(V6115 AS STRING) V6115,
SAFE_CAST(V6116 AS STRING) V6116,
SAFE_CAST(V6117 AS STRING) V6117,
SAFE_CAST(V6118 AS STRING) V6118,
SAFE_CAST(V6119 AS STRING) V6119,
SAFE_CAST(V6120 AS STRING) V6120,
SAFE_CAST(V6121 AS STRING) V6121,
SAFE_CAST(V6101 AS STRING) V6101,
SAFE_CAST(V6102 AS FLOAT64) V6102,
SAFE_CAST(V6103 AS FLOAT64) V6103,
SAFE_CAST(peso AS FLOAT64) peso,
SAFE_CAST(peso_final AS FLOAT64) peso_final
FROM basedosdados-dev.br_ibge_pof_staging.condicoes_vida_2017 AS t